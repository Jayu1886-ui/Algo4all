{% extends "base.html" %}

{% block title %}Dashboard | ALGO4ALL{% endblock %}

{% block content %}
<div class="p-4 space-y-4">
    
    <div id="status-bar" class="p-3 rounded-xl shadow-lg text-center font-bold bg-blue-100 text-blue-800 border border-blue-400 transition-all duration-300">
        <span id="status-message">Connecting to server...</span>
    </div>

    <div class="bg-black text-white p-2 rounded-xl shadow-lg text-center">
        <span class="text-xl font-bold">Trend Signal : </span>
        <span id="trend-signal-call_buy" class="text-green-500 font-bold text-xl hidden">CALL BUY</span>
        <span id="trend-signal-put_buy" class="text-red-500 font-bold text-xl hidden">PUT BUY</span>
        <span id="overall-trend-neutral" class="text-gray-400 font-bold text-xl">Neutral / Indecisive</span>
    </div>

    <div class="bg-gradient-to-r from-blue-700 to-blue-500 text-white p-2 rounded-xl shadow-lg">
        <div class="flex justify-between items-center">
            <span class="text-lg font-bold">Nifty 50 :</span>
            <span id="nifty_50-signal" class="text-lg font-bold">--</span> 
        </div>
        <div class="grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-base">
            <span>LTP : <span id="nifty_50-ltp" class="font-semibold">----.--</span></span>
            <span>SMA 10 : <span id="nifty_50-sma10" class="font-semibold">----.--</span></span>
            <span>SMA 25 : <span id="nifty_50-sma25" class="font-semibold">----.--</span></span>
            <span>SMA 50 : <span id="nifty_50-sma50" class="font-semibold">----.--</span></span>
            <span>SMA 100 : <span id="nifty_50-sma100" class="font-semibold">----.--</span></span>
        </div>
    </div>

    <div class="grid grid-cols-1 sm:grid-cols-2 gap-2">
        
        <div id="option-meta-data" 
            data-expiry-date="" 
            data-atm-strike=""
            class="hidden">
        </div>

        <div class="bg-blue-600 text-white p-2 rounded-lg shadow-lg space-y-1">
            <div class="flex justify-between items-center text-base font-bold">
                <span>ATM CALL: <span id="atm-call-strike">----</span></span>
                <span id="atm-expiry-date" class="text-xs font-normal">--</span>
            </div>      
            <span id="atm-call-key" class="hidden"></span> 
        </div>

        <div class="bg-gray-700 text-white p-2 rounded-lg shadow-lg space-y-1">
            <div class="flex justify-between items-center text-base font-bold">
                <span>ATM PUT: <span id="atm-put-strike">----</span></span>
            </div>
            <span id="atm-put-key" class="hidden"></span>
        </div>

    </div>

    <div id="active-trade-section" class="bg-purple-800 text-white p-3 rounded-xl shadow-lg hidden">
        <div class="flex justify-between items-center text-xl font-bold mb-2">
            <span>ACTIVE TRADE</span>
            <span id="active-trade-type" class="text-yellow-300">--</span>
        </div>
        <div class="grid grid-cols-2 gap-x-4 gap-y-1 text-base">
            <div class="flex justify-between"><span>Instrument</span><span id="active-trade-instrument" class="font-semibold">--</span></div>
            <div class="flex justify-between"><span>Entry Price</span><span id="active-trade-entry-price" class="font-semibold">----.--</span></div>
            
            <div class="flex justify-between text-red-300"><span>Stop Loss (SL)</span><span id="active-trade-stoploss" class="font-semibold">----.--</span></div>
            <div class="flex justify-between text-green-300"><span>Target Price (TP)</span><span id="active-trade-target" class="font-semibold">----.--</span></div>
            
            <div class="col-span-2 flex justify-between items-center mt-2">
                <span class="text-lg font-bold">Live PnL</span>
                <span id="live-pnl" class="text-2xl font-extrabold text-yellow-300">---.--</span>
            </div>
        </div>
        <form id="square-off-form" class="mt-4 text-center">
             <button type="submit" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition-colors">
                 EMERGENCY SQUARE OFF
             </button>
        </form>
    </div>
    
</div>
{% endblock %}

{% block scripts %}
    <script src="{{ url_for('static', filename='js/socket.io.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
{% endblock %}
